!function(e){var t={};function a(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=t,a.d=function(e,t,r){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(a.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)a.d(r,n,function(t){return e[t]}.bind(null,n));return r},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=2)}([function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){this.sound=document.createElement("audio"),this.sound.src=e,this.sound.setAttribute("preload","auto"),this.sound.setAttribute("controls","none"),this.sound.style.display="none",document.body.appendChild(this.sound),this.play=function(){this.sound.play()}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drag=t.audio=t.translateArray=void 0;t.translateArray=[{translatable:"cat",variants:["собака","кот","утка"],translate:["кот"]},{translatable:"dog",variants:["собака","кот","утка"],translate:["собака"]},{translatable:"ball",variants:["машина","дом","мяч"],translate:["мяч"]},{translatable:"phone",variants:["дом","ручка","телефон"],translate:["телефон"]},{translatable:"pen",variants:["собака","перерыв","ручка"],translate:["ручка"]},{translatable:"salary",variants:["перерыв","жалованье","растяжение"],translate:["жалованье"]},{translatable:"even",variants:["равный","ровный","крутой"],translate:["равный"]},{translatable:"candy",variants:["нога","палка","леденец"],translate:["леденец"]},{translatable:"smash",variants:["дом","ломать","прыгать"],translate:["ломать"]},{translatable:"knitted",variants:["сломанный","вязаный","точный"],translate:["вязаный"]}];t.audio=["cat","dog","pan","car","independent","roof","phone","checkout","drive off"];t.drag=["cat","dog","pan","car","independent","roof","phone","checkout","yellow","black"]},function(module,exports,__webpack_require__){"use strict";var _dictionary=__webpack_require__(1),_sound=_interopRequireDefault(__webpack_require__(0));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}String.prototype.capitalize=function(){return this.replace(/(?:^|\s)\S/g,function(e){return e.toUpperCase()})};var shuffle=function(e){for(var t,a,r=e.length;0!==r;)a=Math.floor(Math.random()*r),t=e[r-=1],e[r]=e[a],e[a]=t;return e},canvas=document.createElement("canvas"),context=canvas.getContext("2d");canvas.width=1100,canvas.height=700,context.fillStyle="#382B5F",context.font="25px Comic Sans MS",context.textAlign="center";var qWrapper=document.createElement("div");qWrapper.classList.add("qWrapper");var welcome=document.createElement("div");welcome.classList.add("welcome");var welcomeH2=document.createElement("div");welcomeH2.textContent="Введите ваш никнейм:";var welcomeForm=document.createElement("form"),nickname=document.createElement("input");nickname.type="text";var welcomeSubmit=document.createElement("input");welcomeSubmit.type="submit",welcomeSubmit.value="OK",welcomeForm.appendChild(nickname),welcomeForm.appendChild(welcomeSubmit),welcome.appendChild(welcomeH2),welcome.appendChild(welcomeForm),document.body.appendChild(welcome),welcomeSubmit.addEventListener("click",function(e){e.preventDefault(),drawImages(),gameLoop(),createQ(),document.body.appendChild(canvas),document.body.appendChild(qWrapper),gameState.nickname=nickname.value,welcome.remove()});var leftLegs=["./img/game/body_parts/left_leg_1.png","./img/game/body_parts/left_leg_2.png","./img/game/body_parts/left_leg_3.png"],rightLegs=["./img/game/body_parts/right_leg_1.png","./img/game/body_parts/right_leg_2.png","./img/game/body_parts/right_leg_3.png"],leftHands=["./img/game/body_parts/left_hand_1.png","./img/game/body_parts/left_hand_2.png","./img/game/body_parts/left_hand_3.png"],rightHands=["./img/game/body_parts/right_hand_1.png","./img/game/body_parts/right_hand_2.png"],body=["./img/game/body_parts/body_1.png","./img/game/body_parts/body_2.png","./img/game/body_parts/body_3.png"],head=["./img/game/body_parts/head_1.png","./img/game/body_parts/head_2.png","./img/game/body_parts/head_3.png"],gameState={rounds:0},monster={hp:40,x:760,y:250,breathInc:.05,breathDir:1,breathAmt:0,breathMax:2,state:"idle"},hero={img:"./img/game/girl-min.png",hp:100,x:100,y:260,frameWidth:651,frameHeight:542,frameIndex:0,tickCount:0,ticksPerFrame:4,frameNumber:13,width:300,height:342,state:"idle",frameIndexAttack:9,tickCountAttack:0},spells={heal:"./img/game/heal.png",bullet:"./img/game/hit.png"},lighting=new Image;lighting.src="./img/game/cloud.png";var heal=new Image;heal.src=spells.heal;var bullet=new Image;bullet.src=spells.bullet;var result={},generateMonster=function(){var e=Math.floor(Math.random()*leftLegs.length),t=Math.floor(Math.random()*rightLegs.length),a=Math.floor(Math.random()*leftHands.length),r=Math.floor(Math.random()*rightHands.length),n=Math.floor(Math.random()*body.length),o=Math.floor(Math.random()*head.length);monster.leftLegsImg=new Image,monster.leftLegsImg.src=leftLegs[e],monster.rightLegsImg=new Image,monster.rightLegsImg.src=rightLegs[t],monster.leftHandImg=new Image,monster.leftHandImg.src=leftHands[a],monster.rightHandImg=new Image,monster.rightHandImg.src=rightHands[r],monster.bodyImg=new Image,monster.bodyImg.src=body[n],monster.headImg=new Image,monster.headImg.src=head[o]},generateName=function(){var e=["ужасный","глупый","трусливый","сопливый","крутой","кучерявый"],t=["троль","эльф","зомби","огр","гном","гоблин","человек"],a=["том","макс","дима","джек","вася","саша","катя","таня","джон","шон","вова"],r=Math.floor(Math.random()*e.length),n=Math.floor(Math.random()*t.length),o=Math.floor(Math.random()*a.length);return"".concat(e[r]," ").concat(t[n]," ").concat(a[o]).capitalize()},generateTask=function(){var e=Math.floor(15*Math.random()+1),t=Math.floor(15*Math.random()+1);return{math:e+["+","-","*"][Math.floor(3*Math.random())]+t,translate:_dictionary.translateArray,audio:_dictionary.audio,drag:_dictionary.drag}},drawImages=function(){context.drawImage(background,0,0,canvas.width,canvas.height),context.fillText("Раунд: ".concat(gameState.rounds),canvas.width-120,50),1===monster.breathDir?(monster.breathAmt-=monster.breathInc,monster.breathAmt<-monster.breathMax&&(monster.breathDir=-1)):(monster.breathAmt+=monster.breathInc,monster.breathAmt>monster.breathMax&&(monster.breathDir=1)),context.fillText(monsterName,monster.x+70,monster.y-60),context.fillText("".concat(monster.hp," HP"),monster.x+70,monster.y-20),context.drawImage(monster.bodyImg,monster.x+20,monster.y+140,100,130),context.drawImage(monster.headImg,monster.x,monster.y-monster.breathAmt,150,150),context.drawImage(monster.rightHandImg,0,0,monster.rightHandImg.width/2,monster.rightHandImg.height,monster.x-40,monster.y+150-monster.breathAmt,70,100),"idle"===monster.state&&context.drawImage(monster.leftHandImg,0,0,monster.leftHandImg.width/2,monster.leftHandImg.height,monster.x+90,monster.y+150-monster.breathAmt,70,100),"attacking"===monster.state&&(context.drawImage(monster.leftHandImg,monster.leftHandImg.width/2,0,monster.leftHandImg.width/2,monster.leftHandImg.height,monster.x+50,monster.y+100,70,100),context.drawImage(lighting,hero.x+30,hero.y-190,250,200)),context.drawImage(monster.rightLegsImg,monster.x,monster.y+250,50,70),context.drawImage(monster.leftLegsImg,monster.x+90,monster.y+250,50,70);var e=140;(e*=2)>=280&&(e=140),context.fillText(gameState.nickname,hero.x+130,hero.y-60),context.fillText("".concat(hero.hp," HP"),hero.x+130,hero.y-20),hero.tickCount+=1,hero.tickCount>hero.ticksPerFrame&&(hero.tickCount=0,hero.frameIndex<hero.frameNumber-4?hero.frameIndex+=1:hero.frameIndex=0),"idle"===hero.state&&context.drawImage(heroImg,hero.frameWidth*hero.frameIndex,0,hero.frameWidth,hero.frameHeight,hero.x,hero.y,hero.width,hero.height),"attacking"===hero.state&&(hero.tickCountAttack+=1,hero.tickCountAttack>hero.ticksPerFrame&&(hero.tickCountAttack=0,hero.frameIndexAttack<hero.frameNumber-1?hero.frameIndexAttack+=1:hero.frameIndexAttack=10),context.drawImage(heroImg,hero.frameWidth*hero.frameIndexAttack,0,hero.frameWidth,hero.frameHeight,hero.x,hero.y,hero.width,hero.height),context.drawImage(bullet,monster.x+30,monster.y+170,70,70)),"healing"===hero.state&&(context.drawImage(heroImg,hero.frameWidth*hero.frameIndex,0,hero.frameWidth,hero.frameHeight,hero.x,hero.y,hero.width,hero.height),context.drawImage(heal,hero.x+30,hero.y+160,200,200))},createQ=function createQ(){var modal=document.createElement("div");modal.classList.add("modal");var description=document.createElement("p"),translateOptions=document.createElement("p"),form=document.createElement("form"),answer=document.createElement("input");answer.type="text";var submit=document.createElement("input");submit.type="submit",submit.value="OK";var task=generateTask(),currentTask,numberForTranslate,numberForAudio,numberForDrag,playBtn=document.createElement("button");playBtn.textContent="Play",playBtn.classList.add("playBtn");var taskType=Math.floor(4*Math.random());if(0===taskType&&(currentTask=task.math,description.textContent="Решить: ".concat(currentTask)),1===taskType){currentTask=task.translate,numberForTranslate=Math.floor(Math.random()*currentTask.length);var translatable=currentTask[numberForTranslate].translatable,variants=shuffle(currentTask[numberForTranslate].variants);description.textContent="Перевести: ".concat(translatable),translateOptions.textContent="Варианты: ".concat(variants)}if(2===taskType){var synth=window.speechSynthesis;modal.appendChild(playBtn),currentTask=task.audio,numberForAudio=Math.floor(Math.random()*currentTask.length),description.textContent="Введите услышаное слово";var speech=new SpeechSynthesisUtterance;speech.lang="en-GB",speech.text=currentTask[numberForAudio],playBtn.addEventListener("click",function(e){e.preventDefault(),synth.speak(speech)})}if(3===taskType){currentTask=task.drag,numberForDrag=Math.floor(Math.random()*currentTask.length),description.textContent="Расставьте в правильном порядке";for(var _drag=document.createElement("div"),ul=document.createElement("ul"),word=shuffle(currentTask[numberForDrag].split("")).join(""),i=0;i<currentTask[numberForDrag].length;i++){var li=document.createElement("li");li.textContent=word[i],ul.appendChild(li)}ul.classList.add("drag"),_drag.appendChild(ul),answer=_drag,$(function(){$(".drag").sortable().disableSelection()})}form.appendChild(answer),form.appendChild(submit),modal.appendChild(description),modal.appendChild(translateOptions),modal.appendChild(form),qWrapper.appendChild(modal),submit.addEventListener("click",function(e){if(e.preventDefault(),0===taskType&&(Number(answer.value)===eval(currentTask)?chooseSpell():castSpell("lighting",hero)),1===taskType&&(currentTask[numberForTranslate].translate.indexOf(answer.value.toLowerCase())>-1?chooseSpell():castSpell("lighting",hero)),2===taskType&&(answer.value.toLowerCase()===currentTask[numberForAudio]?chooseSpell():castSpell("lighting",hero)),3===taskType){for(var res="",allDrag=document.getElementsByClassName("drag"),currDrag=allDrag[allDrag.length-1],_i=0;_i<currDrag.childElementCount;_i++)res+=currDrag.children[_i].textContent;res===currentTask[numberForDrag]?chooseSpell():castSpell("lighting",hero)}submit.disabled=!0,answer.disabled=!0,answer.style.color="rgb(179, 179, 179)",submit.style.color="rgb(179, 179, 179)"})},chooseSpell=function(){var e=document.createElement("div");e.classList.add("spell");var t=document.createElement("input");t.type="submit",t.value="OK";var a=document.createElement("div");for(var r in a.classList.add("spellList"),e.appendChild(a),spells)if(spells.hasOwnProperty(r)){var n=document.createElement("label"),o=new Image;o.src="./img/game/icon_spell_"+r+".png",n.setAttribute("for",r);var l=document.createElement("input");l.type="radio",l.name="spell",l.setAttribute("id",r),n.appendChild(l),n.appendChild(o),a.appendChild(n)}e.appendChild(t),document.body.appendChild(e),t.addEventListener("click",function(t){t.preventDefault();for(var a=document.querySelectorAll(".spellList input"),r=0;r<a.length;r++)a[r].checked&&(gameState.selectedSpell=a[r].id);e.remove(),castSpell(gameState.selectedSpell,monster)})},castSpell=function(e,t){t===monster&&("bullet"===e&&(hero.state="attacking",gunSound.play(),monster.hp-=20),"heal"===e&&(hero.state="healing",hero.hp>=100?hero.hp=100:hero.hp+=20,healSound.play())),t===hero&&(monster.state="attacking",hero.hp-=20,lightingSound.play()),setTimeout(function(){hero.state="idle",monster.state="idle",createQ()},300)},createScoreboard=function(){cancelAnimationFrame(loop);var e=document.createElement("div");e.classList.add("scoreboard");var t=document.createElement("div");t.classList.add("result");var a=document.createElement("div"),r=document.createElement("h2"),n=document.createElement("p"),o=document.createElement("div");o.classList.add("topScore");var l=JSON.parse(localStorage.finalGame);l.sort(function(e,t){return t.rounds-e.rounds}),l.forEach(function(e){var t=document.createElement("div");t.classList.add("player");var a=document.createElement("p"),r=document.createElement("p");a.textContent="Имя: ".concat(e.name),r.textContent="Убито монстров: ".concat(e.rounds),t.appendChild(a),t.appendChild(r),o.appendChild(t)}),r.textContent=gameState.nickname,n.textContent="Rounds: ".concat(gameState.rounds),a.appendChild(r),a.appendChild(n),t.appendChild(a),e.appendChild(t),e.appendChild(o),document.body.appendChild(e),endSound.play()},checkState=function(){if(hero.hp<=0){result.name=gameState.nickname,result.rounds=gameState.rounds;var e=JSON.parse(localStorage.getItem("finalGame"))||[];e.push(result),localStorage.setItem("finalGame",JSON.stringify(e)),createScoreboard()}monster.hp<=0&&(qWrapper.innerHTML="",monsterName=generateName(),gameState.rounds++,monster.hp=15*gameState.rounds+40,createQ(),generateMonster())},heroImg=new Image;heroImg.src=hero.img;var heroReady=!1;heroImg.addEventListener("load",function(){heroReady=!0});var background=new Image;background.src="./img/game/background.png";var lightingSound=new _sound.default("./sound/lighting.mp3"),healSound=new _sound.default("./sound/heal.mp3"),gunSound=new _sound.default("./sound/gun.mp3"),endSound=new _sound.default("./sound/blop.mp3"),monsterName=generateName(),loop,gameLoop=function e(){loop=requestAnimationFrame(e),drawImages(),checkState()};generateMonster()}]);